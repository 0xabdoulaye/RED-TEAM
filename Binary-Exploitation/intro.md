## The Basics

```c
#include <stdio.h>
#include <string.h>

int main(void)
{
    char buffer[16];

    printf("Give me data plz: \n");
    gets(buffer);
    
    return 0;
}
```

On voit dans ce code, il a une variable `char` qui est defini pour un maximum de 16 characteres a entrer par l'utililsateur. Et il utilise la fonction `gets()` qui va lire a string qui a ete stockee dans la variable

``└─# gcc vuln.c -o vuln -fno-stack-protector -z execstack -no-pie -m32 -w``

Maintenant je vais commencer l'analyse avec `gef` et aussi ghidra

```sh

─# gdb -q
GEF for linux ready, type `gef' to start, `gef config' to configure
88 commands loaded and 5 functions added for GDB 13.2 in 0.01ms using Python engine 3.11
gef➤  file vuln
Reading symbols from vuln...
(No debugging symbols found in vuln)
gef➤  run
gef➤  b *main 
Breakpoint 1 at 0x8049176
gef➤  run
Starting program: /home/blo/CTFs/Jeopardy/Pwn/vuln 
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".

Breakpoint 1, 0x08049176 in main ()
───────────────────────────────────────────────────────────────────── stack ────
0xffffd30c│+0x0000: 0xf7c237c5  →   add esp, 0x10        ← $esp
0xffffd310│+0x0004: 0x00000001
0xffffd314│+0x0008: 0xffffd3c4  →  0xffffd54e  →  "/home/blo/CTFs/Jeopardy/Pwn/vuln"
0xffffd318│+0x000c: 0xffffd3cc  →  0xffffd56f  →  "COLORTERM=truecolor"
0xffffd31c│+0x0010: 0xffffd330  →  0xf7e1dff4  →  0x0021dd8c
0xffffd320│+0x0014: 0xf7e1dff4  →  0x0021dd8c
0xffffd324│+0x0018: 0x0804908d  →  <_start+45> jmp 0x8049176 <main>
0xffffd328│+0x001c: 0x00000001
─────────────────────────────────────────────────────────────── code:x86:32 ────
    0x8049169 <__do_global_dtors_aux+41> lea    esi, [esi+eiz*1+0x0]
    0x8049170 <frame_dummy+0>  endbr32 
    0x8049174 <frame_dummy+4>  jmp    0x8049100 <register_tm_clones>
 →  0x8049176 <main+0>         lea    ecx, [esp+0x4]
    0x804917a <main+4>         and    esp, 0xfffffff0
    0x804917d <main+7>         push   DWORD PTR [ecx-0x4]
    0x8049180 <main+10>        push   ebp
    0x8049181 <main+11>        mov    ebp, esp
    0x8049183 <main+13>        push   ebx
─────────────────────────────────────────────────────────────────── threads ────
[#0] Id 1, Name: "vuln", stopped 0x8049176 in main (), reason: BREAKPOINT
───────────────────────────────────────────────────────────────────── trace ────
[#0] 0x8049176 → main()
────────────────────────────────────────────────────────────────────────────────
gef➤  info stack
#0  0x08049176 in main ()
gef➤  

```


En ouvrant avec `ghidra` je trouve ce code dans le main qui est similaire au code principal

```c
/* WARNING: Function: __x86.get_pc_thunk.bx replaced with injection: get_pc_thunk_bx */

undefined4 main(undefined param_1)

{
  char local_20 [16];
  undefined1 *local_10;
  
  local_10 = &param_1;
  puts("Give me data plz: ");
  gets(local_20);
  return 0;
}
```

Ok avec `ghidra` j'ai la posibilite de modifier le code pour bien le lire et le comprendre. alors je fais cela