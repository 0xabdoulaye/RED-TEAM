From TryHackMe


## Challenge 1

This should give you a start: 'AAAAAAAAAAA'
Challenge is running on port 9001

- d'abord je vais analyzer le `elf` avec ghidra

```c

void main(void)

{
  char buffer [60];
  int key;
  
  key = 0x539;
  setup();
  banner();
  puts(
      "Hello!, I am going to shopping.\nMy mom told me to buy some ingredients.\nUmmm.. But I have l ow memory capacity, So I forgot most of them.\nAnyway, she is preparing Briyani for lunch, Can  you help me to buy those items :D\n"
      );
  puts("Type the required ingredients to make briyani: ");
  gets(buffer);
  if (key == 0x539) {
    puts("Nah bruh, you lied me :(\nShe did Tomato rice instead of briyani :/");
                    /* WARNING: Subroutine does not return */
    exit(0x539);
  }
  puts("Thanks, Here\'s a small gift for you <3");
  system("/bin/sh");
  return;
}
```

- ce que je comprend est :

- ce programme initialise un `buffer` a 60 caracteres et un key a `0x539`
- ensuite quand je l'execute, le programme appele la fonction `setup` et aussi `banner` et me renvoi un message avec le `puts`
- ensuite le programme verifie si ma reponse est egale a la variable `key` et ca affiche le message de `nah bruh`
- sino ca me renvoi un shell.
- La vulnerabilite ici se trouve dans le `gets()` qui est tres dangereux

je vais creer une reponse superieur a celle du `buffer`